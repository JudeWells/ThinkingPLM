nohup: ignoring input
/home/judewells/miniconda3/envs/profam_bagel/lib/python3.11/site-packages/boileroom/models/esm/esmfold.py:176: DeprecationError: 2025-02-24: We have renamed several parameters related to autoscaling. Please update your code to use the following new names:

- container_idle_timeout -> scaledown_window

See https://modal.com/docs/guide/modal-1-0-migration for more details.
  @app.cls(
/home/judewells/miniconda3/envs/profam_bagel/lib/python3.11/site-packages/boileroom/models/esm/esmfold.py:176: DeprecationError: 2025-04-15: 
<class 'boileroom.models.esm.esmfold.ESMFold'> uses a non-default constructor (__init__) method.
Custom constructors will not be supported in a a future version of Modal.

To parameterize classes, use dataclass-style modal.parameter() declarations instead,
e.g.:


class ESMFold:
    model_name: str = modal.parameter()

More information on class parameterization can be found here: https://modal.com/docs/guide/parametrized-functions

  @app.cls(
/home/judewells/miniconda3/envs/profam_bagel/lib/python3.11/site-packages/boileroom/models/esm/esm2.py:39: DeprecationError: 2025-02-24: We have renamed several parameters related to autoscaling. Please update your code to use the following new names:

- container_idle_timeout -> scaledown_window

See https://modal.com/docs/guide/modal-1-0-migration for more details.
  @app.cls(
/home/judewells/miniconda3/envs/profam_bagel/lib/python3.11/site-packages/boileroom/models/esm/esm2.py:39: DeprecationError: 2025-04-15: 
<class 'boileroom.models.esm.esm2.ESM2'> uses a non-default constructor (__init__) method.
Custom constructors will not be supported in a a future version of Modal.

To parameterize classes, use dataclass-style modal.parameter() declarations instead,
e.g.:


class ESM2:
    model_name: str = modal.parameter()

More information on class parameterization can be found here: https://modal.com/docs/guide/parametrized-functions

  @app.cls(
pynvml not installed, GPU metrics will not be logged. Error: No module named 'pynvml'
âœ“ Initialized. View run at 
https://modal.com/apps/judewells/main/ap-lnnJ1OvTBwrnX4d9FKrCKw
âœ“ Created objects.
â”œâ”€â”€ ðŸ”¨ Created mount /mnt/disk2/ThinkingPLM/run_profam_bagel_modal_app.py
â”œâ”€â”€ ðŸ”¨ Created mount /mnt/disk2/ThinkingPLM
â””â”€â”€ ðŸ”¨ Created function run_pipeline_modal.
/usr/local/lib/python3.11/site-packages/boileroom/models/esm/esmfold.py:176: DeprecationError: 2025-02-24: We have renamed several parameters related to autoscaling. Please update your code to use the following new names:

- container_idle_timeout -> scaledown_window

See https://modal.com/docs/guide/modal-1-0-migration for more details.
  @app.cls(
/usr/local/lib/python3.11/site-packages/boileroom/models/esm/esmfold.py:176: DeprecationError: 2025-04-15: 
<class 'boileroom.models.esm.esmfold.ESMFold'> uses a non-default constructor (__init__) method.
Custom constructors will not be supported in a a future version of Modal.

To parameterize classes, use dataclass-style modal.parameter() declarations instead,
e.g.:


class ESMFold:
    model_name: str = modal.parameter()

More information on class parameterization can be found here: https://modal.com/docs/guide/parametrized-functions

  @app.cls(
/usr/local/lib/python3.11/site-packages/boileroom/models/esm/esm2.py:39: DeprecationError: 2025-02-24: We have renamed several parameters related to autoscaling. Please update your code to use the following new names:

- container_idle_timeout -> scaledown_window

See https://modal.com/docs/guide/modal-1-0-migration for more details.
  @app.cls(
/usr/local/lib/python3.11/site-packages/boileroom/models/esm/esm2.py:39: DeprecationError: 2025-04-15: 
<class 'boileroom.models.esm.esm2.ESM2'> uses a non-default constructor (__init__) method.
Custom constructors will not be supported in a a future version of Modal.

To parameterize classes, use dataclass-style modal.parameter() declarations instead,
e.g.:


class ESM2:
    model_name: str = modal.parameter()

More information on class parameterization can be found here: https://modal.com/docs/guide/parametrized-functions

  @app.cls(
INFO:matplotlib.font_manager:generated new fontManager
pynvml not installed, GPU metrics will not be logged. Error: No module named 'pynvml'
Loading ProFam model from .profam_repo/model_checkpoints/profam-1/checkpoints/last.ckpt (device=cuda, attn=sdpa)...
Initialised Llama model, attention implementation:  sdpa
/usr/local/lib/python3.11/site-packages/lightning/pytorch/core/saving.py:197: Found keys that are not in the model state dict but in the checkpoint: ['model.token_embedder.weight']
ProFam model loaded successfully.
enforce_template=True but no TemplateMatchEnergy found; no positions forced.
=== Starting cycle 1 / 500 ===

[1AGenerating sequences:   0%|          | 0/10 [00:00<?, ?it/s]
[1AGenerating sequences:  10%|â–ˆ         | 1/10 [00:01<00:17,  1.90s/it]
[1AGenerating sequences:  20%|â–ˆâ–ˆ        | 2/10 [00:03<00:12,  1.61s/it]
[1AGenerating sequences:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:04<00:10,  1.51s/it]
[1AGenerating sequences:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:06<00:08,  1.48s/it]
[1AGenerating sequences:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:07<00:07,  1.45s/it]
[1AGenerating sequences:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:08<00:05,  1.43s/it]
[1AGenerating sequences:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:10<00:04,  1.42s/it]
[1AGenerating sequences:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:11<00:02,  1.42s/it]
[1AGenerating sequences:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:13<00:01,  1.44s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.46s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.47s/it]
[checkpoint] Synced 100/100 files (7 cycles) from Modal Volume
  Avg sequence similarity to initial: 0.8324
=== Starting cycle 2 / 500 ===

[1AGenerating sequences:   0%|          | 0/10 [00:00<?, ?it/s]
[1AGenerating sequences:  10%|â–ˆ         | 1/10 [00:01<00:12,  1.42s/it]
[1AGenerating sequences:  20%|â–ˆâ–ˆ        | 2/10 [00:02<00:11,  1.41s/it]
[1AGenerating sequences:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:04<00:09,  1.40s/it]
[1AGenerating sequences:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:05<00:08,  1.40s/it]
[1AGenerating sequences:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:07<00:07,  1.40s/it]
[1AGenerating sequences:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:08<00:05,  1.39s/it]
[1AGenerating sequences:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:09<00:04,  1.40s/it]
[1AGenerating sequences:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:11<00:02,  1.40s/it]
[1AGenerating sequences:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:12<00:01,  1.39s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:13<00:00,  1.40s/it]Generating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:13<00:00,  1.40s/it]
[checkpoint] Synced 114/114 files (8 cycles) from Modal Volume
  Avg sequence similarity to initial: 0.8842
=== Starting cycle 3 / 500 ===

[1AGenerating sequences:   0%|          | 0/10 [00:00<?, ?it/s]
[1AGenerating sequences:  10%|â–ˆ         | 1/10 [00:01<00:12,  1.43s/it]
[1AGenerating sequences:  20%|â–ˆâ–ˆ        | 2/10 [00:02<00:11,  1.39s/it]
[1AGenerating sequences:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:04<00:09,  1.39s/it]
[1AGenerating sequences:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:05<00:08,  1.39s/it]
[1AGenerating sequences:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:06<00:06,  1.39s/it]
[1AGenerating sequences:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:08<00:05,  1.40s/it]
[1AGenerating sequences:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:09<00:03,  1.27s/it]
[1AGenerating sequences:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:10<00:02,  1.31s/it]
[1AGenerating sequences:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:12<00:01,  1.32s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:13<00:00,  1.34s/it]Generating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:13<00:00,  1.35s/it]
[checkpoint] Synced 128/128 files (9 cycles) from Modal Volume
  Avg sequence similarity to initial: 0.8141
=== Starting cycle 4 / 500 ===

[1AGenerating sequences:   0%|          | 0/10 [00:00<?, ?it/s]
[1AGenerating sequences:  10%|â–ˆ         | 1/10 [00:01<00:12,  1.43s/it]
[1AGenerating sequences:  20%|â–ˆâ–ˆ        | 2/10 [00:02<00:11,  1.40s/it]
[1AGenerating sequences:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:04<00:09,  1.39s/it]
[1AGenerating sequences:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:05<00:08,  1.41s/it]
[1AGenerating sequences:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:06<00:06,  1.39s/it]
[1AGenerating sequences:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:08<00:05,  1.39s/it]
[1AGenerating sequences:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:09<00:04,  1.40s/it]
[1AGenerating sequences:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:11<00:02,  1.41s/it]
[1AGenerating sequences:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:12<00:01,  1.42s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.42s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.41s/it]
[checkpoint] Synced 142/142 files (10 cycles) from Modal Volume
  Avg sequence similarity to initial: 0.8412
=== Starting cycle 5 / 500 ===

[1AGenerating sequences:   0%|          | 0/10 [00:00<?, ?it/s]
[1AGenerating sequences:  10%|â–ˆ         | 1/10 [00:01<00:12,  1.43s/it]
[1AGenerating sequences:  20%|â–ˆâ–ˆ        | 2/10 [00:02<00:11,  1.43s/it]
[1AGenerating sequences:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:04<00:09,  1.40s/it]
[1AGenerating sequences:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:05<00:08,  1.41s/it]
[1AGenerating sequences:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:07<00:07,  1.41s/it]
[1AGenerating sequences:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:08<00:05,  1.40s/it]
[1AGenerating sequences:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:09<00:04,  1.41s/it]
[1AGenerating sequences:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:11<00:02,  1.42s/it]
[1AGenerating sequences:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:12<00:01,  1.42s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.41s/it]Generating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.41s/it]
  Avg sequence similarity to initial: 0.8581
=== Starting cycle 6 / 500 ===

[1AGenerating sequences:   0%|          | 0/10 [00:00<?, ?it/s]
[1AGenerating sequences:  10%|â–ˆ         | 1/10 [00:01<00:12,  1.43s/it]
[1AGenerating sequences:  20%|â–ˆâ–ˆ        | 2/10 [00:02<00:11,  1.43s/it]
[1AGenerating sequences:  30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:04<00:09,  1.42s/it]
[1AGenerating sequences:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 4/10 [00:05<00:08,  1.43s/it]
[1AGenerating sequences:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 5/10 [00:07<00:07,  1.42s/it]
[1AGenerating sequences:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:08<00:05,  1.43s/it]
[1AGenerating sequences:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 7/10 [00:09<00:04,  1.42s/it]
[1AGenerating sequences:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:11<00:02,  1.43s/it]
[1AGenerating sequences:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:12<00:01,  1.43s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.43s/it]
[1AGenerating sequences: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:14<00:00,  1.43s/it]
